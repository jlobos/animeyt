(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(g){var f=this.prototype;a=true;var e=new this();a=false;for(var d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super;this._super=f[h];var j=i.apply(this,arguments);this._super=k;return j}})(d,g[d]):g[d]}function c(){if(!a&&this.init){this.init.apply(this,arguments)}}c.prototype=e;c.prototype.constructor=c;c.extend=arguments.callee;return c}})();(function(c){var b={trace:function(d){if(c.console!==undefined){c.console.log("Porthole: "+d)}},error:function(d){if(c.console!==undefined){c.console.error("Porthole: "+d)}}};b.WindowProxy=function(){};b.WindowProxy.prototype={post:function(e,d){},addEventListener:function(d){},removeEventListener:function(d){}};b.WindowProxyBase=Class.extend({init:function(d){if(d===undefined){d=""}this.targetWindowName=d;this.origin=c.location.protocol+"//"+c.location.host;this.eventListeners=[]},getTargetWindowName:function(){return this.targetWindowName},getOrigin:function(){return this.origin},getTargetWindow:function(){return b.WindowProxy.getTargetWindow(this.targetWindowName)},post:function(e,d){if(d===undefined){d="*"}this.dispatchMessage({data:e,sourceOrigin:this.getOrigin(),targetOrigin:d,sourceWindowName:c.name,targetWindowName:this.getTargetWindowName()})},addEventListener:function(d){this.eventListeners.push(d);return d},removeEventListener:function(g){var d;try{d=this.eventListeners.indexOf(g);this.eventListeners.splice(d,1)}catch(h){this.eventListeners=[]}},dispatchEvent:function(f){var d;for(d=0;d<this.eventListeners.length;d++){try{this.eventListeners[d](f)}catch(g){}}}});b.WindowProxyLegacy=b.WindowProxyBase.extend({init:function(d,e){this._super(e);if(d!==null){this.proxyIFrameName=this.targetWindowName+"ProxyIFrame";this.proxyIFrameLocation=d;this.proxyIFrameElement=this.createIFrameProxy()}else{this.proxyIFrameElement=null;throw new Error("proxyIFrameUrl can't be null")}},createIFrameProxy:function(){var d=document.createElement("iframe");d.setAttribute("id",this.proxyIFrameName);d.setAttribute("name",this.proxyIFrameName);d.setAttribute("src",this.proxyIFrameLocation);d.setAttribute("frameBorder","1");d.setAttribute("scrolling","auto");d.setAttribute("width",30);d.setAttribute("height",30);d.setAttribute("style","position: absolute; left: -100px; top:0px;");if(d.style.setAttribute){d.style.setAttribute("cssText","position: absolute; left: -100px; top:0px;")}document.body.appendChild(d);return d},dispatchMessage:function(e){var d=c.encodeURIComponent;if(this.proxyIFrameElement){var f=this.proxyIFrameLocation+"#"+d(b.WindowProxy.serialize(e));this.proxyIFrameElement.setAttribute("src",f);this.proxyIFrameElement.height=this.proxyIFrameElement.height>50?50:100}}});b.WindowProxyHTML5=b.WindowProxyBase.extend({init:function(d,e){this._super(e);this.eventListenerCallback=null},dispatchMessage:function(d){this.getTargetWindow().postMessage(b.WindowProxy.serialize(d),d.targetOrigin)},addEventListener:function(e){if(this.eventListeners.length===0){var d=this;this.eventListenerCallback=function(f){d.eventListener(d,f)};c.addEventListener("message",this.eventListenerCallback,false)}return this._super(e)},removeEventListener:function(d){this._super(d);if(this.eventListeners.length===0){c.removeEventListener("message",this.eventListenerCallback);this.eventListenerCallback=null}},eventListener:function(e,d){var f=b.WindowProxy.unserialize(d.data);if(f&&(e.targetWindowName==""||f.sourceWindowName==e.targetWindowName)){e.dispatchEvent(new b.MessageEvent(f.data,d.origin,e))}}});if(typeof c.postMessage!=="function"){b.trace("Using legacy browser support");b.WindowProxy=b.WindowProxyLegacy.extend({})}else{b.trace("Using built-in browser support");b.WindowProxy=b.WindowProxyHTML5.extend({})}b.WindowProxy.serialize=function(d){if(typeof JSON==="undefined"){throw new Error("Porthole serialization depends on JSON!")}return JSON.stringify(d)};b.WindowProxy.unserialize=function(g){if(typeof JSON==="undefined"){throw new Error("Porthole unserialization dependens on JSON!")}try{var d=JSON.parse(g)}catch(f){return false}return d};b.WindowProxy.getTargetWindow=function(d){if(d===""){return top}else{if(d==="top"||d==="parent"){return c[d]}}return parent.frames[d]};b.MessageEvent=function a(f,d,e){this.data=f;this.origin=d;this.source=e};b.WindowProxyDispatcher={forwardMessageEvent:function(i){var g,h=c.decodeURIComponent,f,d;if(document.location.hash.length>0){g=b.WindowProxy.unserialize(h(document.location.hash.substr(1)));f=b.WindowProxy.getTargetWindow(g.targetWindowName);d=b.WindowProxyDispatcher.findWindowProxyObjectInWindow(f,g.sourceWindowName);if(d){if(d.origin===g.targetOrigin||g.targetOrigin==="*"){d.dispatchEvent(new b.MessageEvent(g.data,g.sourceOrigin,d))}else{b.error("Target origin "+d.origin+" does not match desired target of "+g.targetOrigin)}}else{b.error("Could not find window proxy object on the target window")}}},findWindowProxyObjectInWindow:function(d,g){var f;if(d.RuntimeObject){d=d.RuntimeObject()}if(d){for(f in d){if(d.hasOwnProperty(f)){try{if(d[f]!==null&&typeof d[f]==="object"&&d[f] instanceof d.Porthole.WindowProxy&&d[f].getTargetWindowName()===g){return d[f]}}catch(h){}}}}return null},start:function(){if(c.addEventListener){c.addEventListener("resize",b.WindowProxyDispatcher.forwardMessageEvent,false)}else{if(document.body.attachEvent){c.attachEvent("onresize",b.WindowProxyDispatcher.forwardMessageEvent)}else{b.error("Cannot attach resize event")}}}};if(typeof c.exports!=="undefined"){c.exports.Porthole=b}else{c.Porthole=b}})(this);;var TAWEA_DOMAIN = 'http://tawea.com';;!function(){var a={toolbarWidth:229,chatBoxWidth:260,chatBoxHeight:290,debug:!("http://tawea.com"==TAWEA_DOMAIN||"http://www.tawea.com"==TAWEA_DOMAIN),scrolling:!0,Iframe:function(b,c,d){this.model={id:c+"_"+b,type:c,src:TAWEA_DOMAIN+"/extension/?i="+c+"&url="+encodeURIComponent(document.location)+"&title="+encodeURIComponent(document.title)+d},this.view={visible:!0,proxy:null,container:{element:null,data:{position:"fixed",width:"0px",height:"0px",top:"0",right:"0",overflow:"hidden",display:"none"}},iframe:{element:null,data:{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",border:"none",background:"transparent",scrolling:"no"}},zIndex:"2147483646",parent:document.body,dropLayer:null,dropShow:null},this.init=function(){this.view.container.element=document.createElement("div"),this.view.iframe.element=document.createElement("iframe"),this.view.dropLayer=document.createElement("div"),this.view.dropShow=document.createElement("div");var b=this.view.container.element,c=this.view.dropLayer,d=this.view.dropShow,e=this.view.iframe.element;b.className="Tawea",b.style.zIndex=this.view.zIndex,e.id=this.model.id,e.src=this.model.src,e.name=this.model.id,e.setAttribute("TaweaIgnore",!0);var f=this.view.container.data,g=this.view.iframe.data;for(var h in f)b.style[h]=f[h];for(var h in g)e[h]=g[h],e.style[h]=g[h];this.view.proxy=new Porthole.WindowProxy(this.model.src,this.model.id),this.view.proxy.addEventListener(this.onPrivateMessage.bind(this));var i={height:"100%",width:"100%",top:"0",left:"0",position:"absolute"};for(var h in i)c.style[h]=i[h],d.style[h]=i[h];d.style.display="none",this.view.debug=document.createElement("div"),this.view.debugButton=document.createElement("div"),this.view.postMessageButton=document.createElement("div"),this.view.brotherhoodButton=document.createElement("div");var j=this.view.debug,k=this.view.debugButton,l=this.view.postMessageButton,m=this.view.brotherhoodButton;if(a.debug){k.innerHTML="Worker",k.title="Debug worker messages from this iframe",l.innerHTML="Tab",l.title="Debug postmessage messages from this iframe",m.innerHTML="Brothers",m.title="Debug postmessage messages from this iframe";var n={height:"18px",top:"-18px",left:"0",position:"absolute"};for(var h in n)j.style[h]=n[h];var o={backgroundColor:"rgba(0,0,0,0.7)",color:"rgb(197,197,197)",padding:"2px 5px",opacity:"0.5",cursor:"pointer",position:"relative","float":"left",cssFloat:"left",marginRight:"2px",marginTop:"2px",fontFamily:"'lucida grande',tahoma,verdana,arial,sans-serif",fontSize:"12px",lineHeight:"1.2"};for(var h in o)k.style[h]=o[h],l.style[h]=o[h],m.style[h]=o[h];k.addEventListener("click",this.debugWorker.bind(this,"Worker"),!1),l.addEventListener("click",this.debugWorker.bind(this,"PostMessage"),!1),m.addEventListener("click",this.debugWorker.bind(this,"Brotherhood"),!1),j.appendChild(k),j.appendChild(l),j.appendChild(m),b.appendChild(j)}e.addEventListener("mouseout",function(b){b.preventDefault(),a.scrolling=!0,this.showDiv(this.view.dropLayer,!0),this.iframeOver(!1)}.bind(this),!1),c.addEventListener("mouseover",function(b){b.preventDefault(),a.scrolling=!1,this.showDiv(this.view.dropLayer,!1),this.iframeOver(!0)}.bind(this),!1),k.addEventListener("mouseout",function(){this.view.debugButton.style.opacity="0.5"}.bind(this),!1),k.addEventListener("mouseover",function(){this.view.debugButton.style.opacity="1"}.bind(this),!1),l.addEventListener("mouseout",function(){this.view.postMessageButton.style.opacity="0.5"}.bind(this),!1),l.addEventListener("mouseover",function(){this.view.postMessageButton.style.opacity="1"}.bind(this),!1),m.addEventListener("mouseout",function(){this.view.brotherhoodButton.style.opacity="0.5"}.bind(this),!1),m.addEventListener("mouseover",function(){this.view.brotherhoodButton.style.opacity="1"}.bind(this),!1),j.addEventListener("mouseout",function(){this.view.postMessageButton.style.opacity="0.5",this.view.debugButton.style.opacity="0.5",this.view.brotherhoodButton.style.opacity="0.5"}.bind(this),!1),window.addEventListener("dragstart",function(a){this.isDropping=!1,this.dragEvent(a),this.eventElement=a.target,this.eventElement.addEventListener("dragend",this.dragEventEnd.bind(this),!1)}.bind(this),!1),c.addEventListener("dragleave",this.dragLeave.bind(this),!1),c.addEventListener("dragover",this.dragOver.bind(this),!1),c.addEventListener("drop",this.drop.bind(this),!1),c.addEventListener("dragend",this.dragEnd.bind(this),!1),b.appendChild(e),b.appendChild(d),b.appendChild(c),this.view.parent.appendChild(b)},this.iframeOver=function(a){var b={event:"iframe.over",data:{over:a}};this.send(b)},this.dragEventEnd=function(a){this.dragEvent(a),this.eventElement.removeEventListener(a.type,this.dragEventEnd.bind(this),!1)},this.onPrivateMessage=function(a){this.onMessage(JSON.parse(a.data))},this.send=function(a){this.view.proxy.post(JSON.stringify(a))},this.show=function(){this.view.visible=!0,this.view.container.element.style.display="block",this.resizeDebug()},this.close=function(){this.view.container.element.parentElement.removeChild(this.view.container.element),this.view.proxy.removeEventListener(this.onPrivateMessage.bind(this)),delete this.view.proxy},this.hide=function(){this.view.visible=!1,this.view.container.element.style.display="none"},this.setBounds=function(a){for(var b in a)this.view.container.element.style[b]=a[b];this.resizeDebug(),window.setTimeout(function(){this.resizeDebug()}.bind(this),300)},this.resizeDebug=function(){a.debug&&(this.view.debug.style.top="-"+Math.max(18,this.view.debug.scrollHeight)+"px")},this.showDiv=function(a,b){var c="none";b&&(c="block"),a.style.display=c},this.dragLeave=function(a){this.showDiv(this.view.dropShow,!1),this.dragEvent(a)},this.dragOver=function(b){if(b.preventDefault&&b.preventDefault(),this.showDiv(this.view.dropShow,!0),b.dataTransfer.effectAllowed="all",b.dataTransfer.dropEffect="copy",0==b.layerY%2||0==b.layerX%4){var c,d;if(null!=b.offsetX)c=b.offsetX,d=b.offsetY;else{var e=a.Instances.taws.elementBounds(this.view.dropShow);c=b.clientX-e.left,d=b.clientY-e.top}this.dragEvent(b,{x:c,y:d})}return!1},this.drop=function(a){return a.stopPropagation(),a.preventDefault(),this.isDropping=!0,this.dropAction(a.dataTransfer),this.showDiv(this.view.dropShow,!1),this.showDiv(this.view.dropLayer,!1),!1},this.dragEnd=function(a){this.showDiv(this.view.dropShow,!1),this.isDropping||this.dragEvent(a)},this.dragEvent=function(a,b){var c={event:"drag.event",data:{type:a.type}};null!=b&&(c.data.coordinates=b),this.send(c)},this.debugWorker=function(a){var b={event:"console.open",data:{type:a}};this.send(b)}},Iframes:{Toolbar:function(){a.Iframe.call(this,"Toolbar","toolbar",""),this.view.container.data={position:"fixed",width:a.toolbarWidth+"px",height:"0",bottom:"0",right:"0",maxHeight:window.innerHeight+"px",display:"none",zIndex:"2147483645",webkitTransition:"all 0.3s ease",MozTransition:"all 0.3s ease",oTransition:"all 0.3s ease"},null!=document.body&&(this.isInitialized=!0,this.initTawea(),this.view.parent=a.Instances.chatboxes.container,this.init()),document.addEventListener("DOMContentLoaded",function(){this.isInitialized||(this.initTawea(),this.view.parent=a.Instances.chatboxes.container,this.init(),console.log("Not so fast, my friend."))}.bind(this),!1),window.addEventListener("mousewheel",function(a){this.mouseScroll(a)}.bind(this),!1),window.addEventListener("DOMMouseScroll",function(a){this.mouseScroll(a)}.bind(this),!1),document.addEventListener("load",function(){a.Instances.taws.analizeDrag()}.bind(this),!1),this.mouseScroll=function(b){!a.scrolling&&b.stopPropagation&&(b.stopPropagation(),b.preventDefault())},this.onResize=function(a){this.view.container.element.style.maxHeight=a+"px",this.view.iframe.element.style.maxHeight=a+"px"}},Chatbox:function(b,c,d,e){var f="&id="+b;"undefined"!=typeof d&&d&&(f+="&focus=true"),a.Iframe.call(this,b,"chatbox",f),this.view.parent=a.Instances.chatboxes.container,this.view.container.data={width:a.chatBoxWidth+"px",height:a.chatBoxHeight+"px",position:"relative","float":"right",marginTop:"-289px",marginRight:"-1px",webkitTransition:"all 0.3s ease",MozTransition:"all 0.3s ease",oTransition:"all 0.3s ease",display:"block",display:"none",cssFloat:"right",zIndex:"2147483644"},c||(this.view.container.data.width="160px",this.view.container.data.marginTop=e?"-3px":"-28px"),this.init(),this.onResize=function(b){parseInt(this.view.container.element.style.width)>a.chatBoxWidth-1&&(this.view.iframe.element.style.maxHeight=b+"px",this.view.container.element.style.marginTop=b<a.chatBoxHeight?-1*b+1+"px":-1*a.chatBoxHeight+1+"px")}},Popup:function(){a.Iframe.call(this,Math.floor(1e9*Math.random()+1),"popup",""),this.init()},Taw:function(b,c){a.Iframe.call(this,b,"taw",""),this.view.parent=a.Instances.chatboxes.container,this.view.container.data={width:"100%",height:"100%",position:"fixed",top:"0",left:"0",display:"none",zIndex:"2147483645"};var d="/";"/"==c[c.length-1]&&(d=""),this.model.src=c+d+"embed",this.init(),this.view.debug.style.top="0"}},Set:function(){this.instances={},this.instancesCount=0,this.positions=[],this.container=null,this.add=function(a){this.instances.hasOwnProperty(a.model.id)||(this.instances[a.model.id]=a,this.positions.push(a),this.instancesCount++)},this.remove=function(a){this.removeById(a.model.id)},this.removeById=function(a){if(this.instances.hasOwnProperty(a)){delete this.instances[a];for(var b=0;b<this.positions.length;b++)this.positions[b].model.id==a&&this.positions.splice(b,1);this.instancesCount--}},this.show=function(a){this.instances[a].show()},this.hide=function(a){this.instances[a].hide()},this.close=function(){this.container.parentElement.removeChild(this.container),this.container=null}},Sets:{Chatboxes:function(){a.Set.call(this),this.container=document.createElement("div");var b={position:"fixed",bottom:"1px",left:"0",width:"100%",height:"0px",zIndex:"2147483647",className:"Tawea"};for(var c in b)this.container.style[c]=b[c];this.offsetDiv=document.createElement("div"),b={width:a.toolbarWidth+"px",height:"290px",position:"relative","float":"right",marginTop:"-1px",cssFloat:"right",cssFloat:"right",webkitTransition:"all 0.3s ease",MozTransition:"all 0.3s ease",oTransition:"all 0.3s ease"};for(var c in b)this.offsetDiv.style[c]=b[c];this.container.appendChild(this.offsetDiv),document.body.appendChild(this.container)},Popups:function(){a.Set.call(this),this.addPopup=function(){this.add(new a.Iframes.Popup)}},Taws:function(){a.Set.call(this),this.dragElements=[],this.isVisible=!1,this.lastTaw=null,this.addTaw=function(b){null!=this.lastTaw&&(this.lastTaw.close(),this.removeById(this.lastTaw.model.id));var c=new a.Iframes.Taw(b.id,b.url);this.add(c),this.lastTaw=c},this.tawsTypes={img:"IMG",video:"VIDEO",video_HTML5:"VIDEO_HTML5",iframe:"IFRAME"},this.regex={youtube:{url:/^(http|https):\/\/www.youtube.com/,id:function(a){var b=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,c=a.match(b);return this.offset=a!=window.location.toString()&&a.toLowerCase().indexOf("showinfo=0")<0?{x:5,y:35}:null,c&&11==c[7].length?c[7]:window.hasOwnProperty("yt")?yt.config_.VIDEO_ID:null}},vimeo:{url:/^(http|https):\/\/(vimeo.com|player.vimeo.com)/,id:function(a){var b=a.match(/^.*(vimeo.com\/)(.*\/)?([^#\?]*)/);return b?b[3]||b[1]:null}},dailymotion:{url:/^(http|https):\/\/www.dailymotion.com/,id:function(a){var b=a.match(/^.+dailymotion.com\/(video|hub|embed\/video)\/([^_]+)[^#]*(#video=([^_&]+))?/);return null!==b?void 0!==b[4]?b[4]:b[2]:null}}}}},iframe:function(){},set:function(){},setProto:function(a,b,c){a.prototype=b,a.prototype.constructor=a,a.prototype._super=c},setProtoIframe:function(b){this.setProto(b,new a.iframe,a.Iframe.prototype)},setProtoSet:function(b){this.setProto(b,new a.set,a.Set.prototype)},Instances:{}};a.Iframe.prototype.dropAction=function(){},a.Iframe.prototype.onMessage=function(a,b){"iframe.visibility"==a.event?"visible"==a.data.visibility||1==a.data.visibility?b.show():b.hide():"iframe.bounds"==a.event?b.setBounds(a.data.bounds):"iframe.close"==a.event&&b.close()},a.iframe.prototype=a.Iframe.prototype,a.set.prototype=a.Set.prototype;for(var b in a.Iframes)a.setProtoIframe(a.Iframes[b]);for(var b in a.Sets)a.setProtoSet(a.Sets[b]);if(a.Iframes.Toolbar.prototype.onMessage=function(b){if(this._super.onMessage(b,this),"tawea.init"==b.event){if(a.Instances.taws.analizeDrag(),a.Instances.chatboxes.instancesCount<1)for(var c=0;c<b.data.boxesStatus.length;c++)a.Instances.chatboxes.add(new a.Iframes.Chatbox(b.data.boxesStatus[c].id,b.data.boxesStatus[c].status,!1,b.data.autoHide))}else if("chat.box.open"==b.event)a.Instances.chatboxes.add(new a.Iframes.Chatbox(b.data.id,!0,b.data.focus,!1));else if("user.login"==b.event)this.login();else if("iframe.visibility"==b.event)a.Instances.taws.changeVisibility(b.data.visibility);else if("iframe.bounds"==b.event){var d={width:"width","float":"float",cssFloat:"cssFloat"};for(var c in d)b.data.bounds.hasOwnProperty(c)&&(a.Instances.chatboxes.offsetDiv.style[c]=b.data.bounds[c])}},a.Iframes.Toolbar.prototype.dropAction=function(b){this._super.dropAction(b,this),a.Instances.taws.tawDrop(b,this)},a.Iframes.Toolbar.prototype.initTawea=function(){a.Instances.chatboxes=new a.Sets.Chatboxes,a.Instances.taws=new a.Sets.Taws,a.Instances.popups=new a.Sets.Popups,a.Instances.taws.analizeDrag()},a.Sets.Taws.prototype.tawFix=function(){},a.Sets.Taws.prototype.newItem=function(a,b){return{type:a,value:b}},a.Sets.Taws.prototype.tawDrop=function(b,c){console.log("TAWDROP en Taws");var d,e=[];null!=c.eventElement.attributes&&(d=c.eventElement.getAttribute("data-type"));var f;if(f=c.eventElement.nodeName,null!=d&&d.indexOf("taw_tawea_")>=0){var g=document.getElementById(c.eventElement.getAttribute("data-id"));if(f=c.eventElement.getAttribute("data-element"),f==a.Instances.taws.tawsTypes.video)e.push(this.newItem("text/html",g.outerHTML));else if(f==a.Instances.taws.tawsTypes.video_HTML5){e.push(this.newItem("text/html",g.outerHTML));var h=g.getElementsByTagName("video")[0];null==h&&(h=g);var i=h.getAttribute("src");null!=i&&e.push(this.newItem("src",i));var j=h.getAttribute("poster");null!=j&&e.push(this.newItem("poster",j));for(var k=g.getElementsByTagName("source"),l=[],m=0;m<k.length;m++){for(var n={},o=0;o<k[m].attributes.length;o++)n[k[m].attributes[o].nodeName]=k[m].attributes[o].nodeValue;l.push(n)}e.push(this.newItem("sources",l))}else{var p=c.eventElement.getAttribute("data-idVideo");e.push(this.newItem("text/plain",p)),e.push(this.newItem("text/uri-list",g.src))}}else if(c.eventElement.nodeName==a.Instances.taws.tawsTypes.img){var q="text/plain";b.types.length>2?e.push(this.newItem(q,b.getData(q))):e.push(this.newItem(q,"")),e.push(this.newItem("text/uri-list",c.eventElement.src)),e.push(this.newItem("text/html",c.eventElement.outerHTML.replace(/\"/g,"'")));var r=c.eventElement.getAttribute("alt");r&&e.push(this.newItem("data",{alt:r}))}else for(var m in b.types)e.push(this.newItem(b.types[m],b.getData(b.types[m]).replace(/\"/g,"'")));c.send(this.sendTaw(f,e))},a.Sets.Taws.prototype.sendTaw=function(a,b){var c={event:"taw.drop",data:{origin:window.location.toString(),nodeName:a.toLowerCase(),data:b}};return c},a.Sets.Taws.prototype.elementBounds=function(a){return a.getBoundingClientRect()},a.Sets.Taws.prototype.analizeDrag=function(){this.tawFix();var a={url:{youtube:"youtube",vimeo:"vimeo"},elements:{iframe:"iframe",object:"object",embed:"embed",video:"video"}},b={position:"absolute",top:"35px",left:"0",draggable:"true",zIndex:"2147483647",padding:"0",margin:"0",visibility:"hidden"},c={width:"30px",height:"30px",opacity:"0.6",cursor:"pointer",backgroundColor:"rgba(0,0,0,0.1)","float":"left"},d={position:"absolute",top:"0",left:"0",backgroundColor:"rgba(0,0,0,0.6)",height:"30px",padding:"0 6px",marginLeft:"40px","float":"left",display:"none",whiteSpace:"nowrap",color:"white",fontFamily:"'lucida grande',tahoma,verdana,arial,sans-serif",fontSize:"9px",lineHeight:"3"},e={width:"0",height:"0",borderTop:"6px solid transparent",borderBottom:"6px solid transparent",borderRight:"6px solid rgba(0,0,0,0.6)",position:"absolute",left:"0",top:"0",margin:"9px 0 0 34px",display:"none"};window.addEventListener("DOMNodeInserted",function(a){null!=a.srcElement&&this.obj.newDrag(a.srcElement,this.videos,this.contStyle,this.imgStyle,this.tipStyle,this.arrowStyle)}.bind({obj:this,videos:a,contStyle:b,imgStyle:c,tipStyle:d,arrowStyle:e}),!1);for(var f in a.elements)for(var g,h=document.getElementsByTagName(f),i=0;i<h.length;i++)g=h[i],null!=g&&this.newDrag(g,a,b,c,d,e)},a.Sets.Taws.prototype.newDrag=function(a,b,c,d,e,f){if(a.childElementCount>0)for(var g=0;g<a.childNodes.length;g++)null!=a.childNodes[g]&&this.newDrag(a.childNodes[g],b,c,d,e,f);var h=a.nodeName.toLowerCase();if(b.elements.hasOwnProperty(h)){var i=!1;if(a.childElementCount>0)for(var j=0;j<a.childElementCount;j++)if(b.elements.hasOwnProperty(a.childNodes[j].nodeName)){i=!0;break}a.getAttribute("tawea_share")&&(i=!0),i||a.getAttribute("TaweaIgnore")||this.dragElements.push(new this.TawDrag(a,h,h+"_"+Math.floor(1e9*Math.random()+1),c,d,e,f,this.regex,this.isVisible))}},a.Sets.Taws.prototype.removeDrag=function(){for(var a in this.dragElements)this.dragElements[a].close();this.dragElements=[]},a.Sets.Taws.prototype.changeVisibility=function(a){if("visible"==a||1==a){this.isVisible=!0;for(var b=0;b<this.dragElements.length;b++)this.dragElements[b].show()}else{this.isVisible=!1;for(var b=0;b<this.dragElements.length;b++)this.dragElements[b].hide()}},a.Sets.Taws.prototype.TawDrag=function(b,c,d,e,f,g,h,i,j){this.video=b,this.type=c,this.id=d,this.regex=i,this.dragElement=null,this.dragCont=null,this.selectEvent=null,this.container=null,this.tip=null,this.arrow=null,this.offset={x:5,y:5},this.init=function(b,c,d,e,f){this.container=document.createElement("div"),this.dragElement=document.createElement("img"),this.dragElement.src=TAWEA_DOMAIN+"/extension/img/icons/tawea_share.png",this.dragCont=document.createElement("div"),this.dragCont.setAttribute("draggable","true"),this.dragCont.appendChild(this.dragElement),this.tip=document.createElement("div"),this.arrow=document.createElement("div"),this.tip.innerHTML="Drag me to share this video";for(var g in b)this.container.style[g]=b[g];for(var g in c)this.dragCont.style[g]=c[g];for(var g in d)this.tip.style[g]=d[g];for(var g in e)this.arrow.style[g]=e[g];this.selectEvent=this.onParentOver()?this.video.parentElement:this.video,this.onResize(),null==this.video.getAttribute("id")&&this.video.setAttribute("id","taw_tawea_"+this.id),this.setAttribute("data-id",this.video.id),this.setAttribute("data-type","taw_tawea_"+this.type),this.videoType="video"==this.type?a.Instances.taws.tawsTypes.video_HTML5:a.Instances.taws.tawsTypes.video,this.setAttribute("data-element",this.videoType),this.video.setAttribute("tawea_share",!0),f?this.show():this.hide();var h=this.video.getAttribute("data");null!=h&&this.checkSrc(h),null!=this.video.getAttribute("src")&&this.checkSrc(this.video.src),this.checkSrc(window.location.toString()),this.videoType!=a.Instances.taws.tawsTypes.video?(this.addEvents(),this.container.appendChild(this.dragCont),this.container.appendChild(this.arrow),this.container.appendChild(this.tip),document.body.appendChild(this.container)):delete this},this.setAttribute=function(a,b){this.dragElement.setAttribute(a,b),this.dragCont.setAttribute(a,b)},this.checkSrc=function(b){for(var c in this.regex)if(b.match(this.regex[c].url)){var d=this.regex[c].id(b);d&&((b!=window.location.toString()||b==window.location.toString()&&this.type!=a.Instances.taws.tawsTypes.iframe.toLowerCase())&&(this.videoType=c.toUpperCase()),this.setAttribute("data-idVideo",d),this.setAttribute("data-element",this.videoType),null!=this.regex[c].offset&&(this.offset=this.regex[c].offset))}},this.onParentOver=function(){var a=window.location.toString().match(this.regex.youtube.url);return a||"video"==this.type?!0:!1},this.close=function(){this.removeEvents(),document.body.removeChild(this.container),delete this},this.addEvents=function(){this.selectEvent.addEventListener("mouseover",this.over.bind(this),!1),this.selectEvent.addEventListener("mouseout",this.out.bind(this),!1),this.container.addEventListener("mouseover",this.over.bind(this),!1),this.container.addEventListener("mouseout",this.out.bind(this),!1),this.dragElement.addEventListener("mouseover",this.overDrag.bind(this),!1),this.dragElement.addEventListener("mouseout",this.outDrag.bind(this),!1)},this.removeEvents=function(){this.selectEvent.removeEventListener("mouseover",this.over.bind(this),!1),this.selectEvent.removeEventListener("mouseout",this.out.bind(this),!1),this.container.removeEventListener("mouseover",this.over.bind(this),!1),this.container.removeEventListener("mouseout",this.out.bind(this),!1),this.dragElement.removeEventListener("mouseover",this.overDrag.bind(this),!1),this.dragElement.removeEventListener("mouseout",this.outDrag.bind(this),!1)},this.overDrag=function(){this.dragCont.style.opacity="1",this.tip.style.display="block",this.arrow.style.display="block"},this.outDrag=function(){this.dragCont.style.opacity="0.6",this.tip.style.display="none",this.arrow.style.display="none"},this.over=function(){this.container.style.visibility="visible",this.onResize()},this.out=function(){this.container.style.visibility="hidden"},this.show=function(){this.container.style.display="block"},this.hide=function(){this.container.style.display="none"},this.onResize=function(){var b=a.Instances.taws.elementBounds(this.video);(0==b.height||0==b.width)&&(b=a.Instances.taws.elementBounds(this.video.parentElement));var c=this.offset.y+b.top+document.body.scrollTop,d=this.offset.x+b.left+document.body.scrollLeft;this.container.style.left=d+"px",this.container.style.top=c+"px"},this.init(e,f,g,h,j)},a.Iframes.Chatbox.prototype.onMessage=function(b){this._super.onMessage(b,this),"chat.box.close"==b.event?(this.close(),a.Instances.chatboxes.removeById(this.model.id)):"taw.open"==b.event&&a.Instances.taws.addTaw(b.data)},a.Iframes.Chatbox.prototype.dropAction=function(b){this._super.dropAction(b,this),a.Instances.taws.tawDrop(b,this)},a.Sets.Chatboxes.prototype.create=function(b){var c=new a.Iframes.Chatbox(b);this.add(c)},a.Iframes.Popup.prototype.onMessage=function(b){this._super.onMessage(b,this),"iframe.close"==b.event&&a.Instances.popups.removeById(this.model.id)},a.Iframes.Taw.prototype.onMessage=function(b){if(this._super.onMessage(b,this),"iframe.close"==b.event)a.Instances.taws.removeById(this.model.id),a.Instances.taws.lastTaw=null;else if("taw.move"==b.event){var c=a.Instances.chatboxes,d=b.data.x,e=b.data.y;if(c.instancesCount>0)for(var f in c.instances)this.isIframe(c.instances[f].view.container.element,d,e);this.isIframe(a.Instances.toolbar.view.container.element,d,e)}},a.Iframes.Taw.prototype.isIframe=function(b,c,d){var e=a.Instances.taws.elementBounds(b);b.style.zIndex=c>e.left&&c<e.left+e.width&&d>e.top&&d<e.top+e.height?"2147483646":"2147483644"},!window.isPopup&&top==self){var c=window.location.pathname;c&&"/extension/report.php"==c||(a.Instances.toolbar=new a.Iframes.Toolbar)}a.debug&&(window.TaweaController=a)}();